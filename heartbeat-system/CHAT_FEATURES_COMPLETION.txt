â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    å¥½å‹åŠèŠå¤©åŠŸèƒ½å®Œå–„ - å®Œæˆç¸½çµ                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… å®Œæˆæ™‚é–“: 2025å¹´10æœˆ8æ—¥
ğŸ¯ éœ€æ±‚: å®Œå–„å¥½å‹åŠèŠå¤©åŠŸèƒ½

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… å·²å®ŒæˆåŠŸèƒ½
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. é…å°æˆåŠŸè‡ªå‹•å‰µå»º5åˆ†é˜è‡¨æ™‚èŠå¤©å®¤
   â”œâ”€ å‰µå»ºé…å°æ™‚è‡ªå‹•è§¸ç™¼
   â”œâ”€ èŠå¤©å®¤é¡å‹: "temporary"
   â”œâ”€ æœ‰æ•ˆæœŸ: 5åˆ†é˜
   â””â”€ API: POST /api/pairing/match

2. 5åˆ†é˜å¾Œè‡ªå‹•å‰µå»ºå¥½å‹é‚€è«‹
   â”œâ”€ å‰ç«¯å®šæ™‚æª¢æŸ¥èŠå¤©å®¤éæœŸç‹€æ…‹
   â”œâ”€ éæœŸå¾Œç³»çµ±è‡ªå‹•å‰µå»ºå¥½å‹é‚€è«‹
   â”œâ”€ é‚€è«‹æœ‰æ•ˆæœŸ: 24å°æ™‚
   â””â”€ API: POST /api/pairing/chat-room/{id}/check-expiry

3. é›™æ–¹æ¥å—å¾Œæˆç‚ºå¥½å‹
   â”œâ”€ æ¯å€‹ç”¨æˆ¶ç¨ç«‹å›æ‡‰é‚€è«‹
   â”œâ”€ é›™æ–¹éƒ½æ¥å—å¾Œè‡ªå‹•å»ºç«‹å¥½å‹é—œä¿‚
   â”œâ”€ è‡¨æ™‚èŠå¤©å®¤è‡ªå‹•å‡ç´šç‚ºæ°¸ä¹…èŠå¤©å®¤
   â””â”€ API: POST /api/pairing/invitations/{id}/respond

4. å¥½å‹å¯æŸ¥çœ‹åœ¨ç·šç‹€æ…‹
   â”œâ”€ ç²å–å¥½å‹åˆ—è¡¨å«åœ¨ç·šç‹€æ…‹
   â”œâ”€ is_online æ¬„ä½ (ç›®å‰ç‚ºæ¨¡æ“¬æ•¸æ“š)
   â”œâ”€ last_seen æœ€å¾Œä¸Šç·šæ™‚é–“
   â””â”€ API: GET /api/pairing/friends

5. æ°¸ä¹…èŠå¤©å®¤åŠŸèƒ½
   â”œâ”€ å¥½å‹ä¹‹é–“çš„èŠå¤©å®¤æ°¸ä¸éæœŸ
   â”œâ”€ é¡å‹: "permanent"
   â”œâ”€ expires_at: null
   â””â”€ API: GET /api/pairing/chat-rooms

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ æ–°å¢çš„è³‡æ–™åº«è¡¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. chat_rooms (èŠå¤©å®¤è¡¨)
   â”œâ”€ id, user_id_1, user_id_2
   â”œâ”€ room_type: "temporary" / "permanent"
   â”œâ”€ is_active: æ˜¯å¦å•Ÿç”¨
   â”œâ”€ expires_at: éæœŸæ™‚é–“
   â”œâ”€ pairing_id: é—œè¯çš„é…å°
   â””â”€ created_at: å‰µå»ºæ™‚é–“

2. friend_invitations (å¥½å‹é‚€è«‹è¡¨)
   â”œâ”€ id, chat_room_id
   â”œâ”€ user_id_1, user_id_2
   â”œâ”€ user_1_response, user_2_response
   â”œâ”€ status: "pending" / "both_accepted" / "rejected"
   â”œâ”€ expires_at: é‚€è«‹éæœŸæ™‚é–“(24å°æ™‚)
   â””â”€ created_at: å‰µå»ºæ™‚é–“

3. æ›´æ–° messages è¡¨
   â”œâ”€ æ–°å¢ is_read: æ˜¯å¦å·²è®€
   â””â”€ æ–°å¢ chat_room_id: æ‰€å±¬èŠå¤©å®¤

4. æ›´æ–° pairings è¡¨
   â””â”€ æ–°å¢ matched_at: é…å°æˆåŠŸæ™‚é–“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”§ æ–°å¢çš„å¾Œç«¯æ–‡ä»¶
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ backend/app/services/
   â””â”€ pairing_service.py (NEW)
      â”œâ”€ create_pairing() - å‰µå»ºé…å°
      â”œâ”€ create_temporary_chat_room() - å‰µå»ºè‡¨æ™‚èŠå¤©å®¤
      â”œâ”€ check_and_create_friend_invitation() - æª¢æŸ¥ä¸¦å‰µå»ºå¥½å‹é‚€è«‹
      â”œâ”€ respond_to_friend_invitation() - å›æ‡‰é‚€è«‹
      â”œâ”€ create_friendship() - å‰µå»ºå¥½å‹é—œä¿‚
      â”œâ”€ get_user_chat_rooms() - ç²å–èŠå¤©å®¤åˆ—è¡¨
      â”œâ”€ get_active_chat_room() - ç²å–æ´»èºèŠå¤©å®¤
      â”œâ”€ get_pending_friend_invitations() - ç²å–å¾…è™•ç†é‚€è«‹
      â”œâ”€ is_friends() - æª¢æŸ¥å¥½å‹é—œä¿‚
      â””â”€ get_user_friends() - ç²å–å¥½å‹åˆ—è¡¨

ğŸ“ backend/app/schemas/
   â””â”€ pairing.py (NEW)
      â”œâ”€ PairingCreate, PairingResponse
      â”œâ”€ ChatRoomResponse, ChatRoomDetail
      â”œâ”€ FriendInvitationResponse, FriendInvitationDetail
      â”œâ”€ RespondInvitationRequest
      â”œâ”€ FriendshipResponse
      â””â”€ FriendDetail

ğŸ“ backend/app/api/
   â””â”€ pairing.py (NEW)
      â”œâ”€ POST /api/pairing/match
      â”œâ”€ GET /api/pairing/chat-rooms
      â”œâ”€ GET /api/pairing/chat-room/{other_user_id}
      â”œâ”€ POST /api/pairing/chat-room/{id}/check-expiry
      â”œâ”€ GET /api/pairing/invitations
      â”œâ”€ POST /api/pairing/invitations/{id}/respond
      â”œâ”€ GET /api/pairing/friends
      â””â”€ GET /api/pairing/is-friend/{user_id}

ğŸ“ backend/
   â””â”€ migrate_chat_features.py (NEW) - è³‡æ–™åº«é·ç§»è…³æœ¬

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“– API ç«¯é»æ¸…å–®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€é…å°èˆ‡èŠå¤©å®¤ã€‘
POST   /api/pairing/match                      å‰µå»ºé…å°(è‡ªå‹•å‰µå»º5åˆ†é˜èŠå¤©å®¤)
GET    /api/pairing/chat-rooms                 ç²å–æˆ‘çš„æ‰€æœ‰èŠå¤©å®¤
GET    /api/pairing/chat-room/{user_id}        ç²å–èˆ‡ç‰¹å®šç”¨æˆ¶çš„èŠå¤©å®¤
POST   /api/pairing/chat-room/{id}/check-expiry æª¢æŸ¥èŠå¤©å®¤éæœŸç‹€æ…‹

ã€å¥½å‹é‚€è«‹ã€‘
GET    /api/pairing/invitations                ç²å–æˆ‘çš„å¾…è™•ç†å¥½å‹é‚€è«‹
POST   /api/pairing/invitations/{id}/respond   å›æ‡‰å¥½å‹é‚€è«‹

ã€å¥½å‹ç®¡ç†ã€‘
GET    /api/pairing/friends                    ç²å–å¥½å‹åˆ—è¡¨(å«åœ¨ç·šç‹€æ…‹)
GET    /api/pairing/is-friend/{user_id}        æª¢æŸ¥æ˜¯å¦ç‚ºå¥½å‹

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¬ ç”¨æˆ¶é«”é©—æµç¨‹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æ­¥é©Ÿ 1: ç”¨æˆ¶A èˆ‡ ç”¨æˆ¶B é…å°æˆåŠŸ
       â†“
       âœ… ç³»çµ±è‡ªå‹•å‰µå»º5åˆ†é˜è‡¨æ™‚èŠå¤©å®¤

æ­¥é©Ÿ 2: é›™æ–¹åœ¨è‡¨æ™‚èŠå¤©å®¤ä¸­èŠå¤©
       â†“
       â° å€’è¨ˆæ™‚: 4:59, 4:58, 4:57...

æ­¥é©Ÿ 3: 5åˆ†é˜åˆ°æœŸ
       â†“
       ğŸ”” é›™æ–¹æ”¶åˆ°å¥½å‹é‚€è«‹é€šçŸ¥
       "æ‚¨å’Œ XXX çš„èŠå¤©æ™‚é–“å·²åˆ°,æ˜¯å¦è¦æˆç‚ºå¥½å‹?"

æ­¥é©Ÿ 4: é›™æ–¹å›æ‡‰é‚€è«‹
       User A: [æ¥å—] âœ…    User B: [æ¥å—] âœ…
       â†“
       ğŸ‰ æˆç‚ºå¥½å‹!

æ­¥é©Ÿ 5: äº«å—æ°¸ä¹…èŠå¤©å®¤
       â”œâ”€ èŠå¤©å®¤æ°¸ä¸éæœŸ
       â”œâ”€ å¯æŸ¥çœ‹å°æ–¹åœ¨ç·šç‹€æ…‹ ğŸŸ¢
       â””â”€ éš¨æ™‚ç™¼é€è¨Šæ¯

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ§ª æ¸¬è©¦æ–¹æ³•
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

è©³ç´°æ¸¬è©¦æ­¥é©Ÿè«‹åƒé–±: PAIRING_CHAT_GUIDE.md

å¿«é€Ÿæ¸¬è©¦:
1. å‰µå»ºå…©å€‹æ¸¬è©¦å¸³è™Ÿ
2. å¸³è™Ÿ1 é…å° å¸³è™Ÿ2
3. æŸ¥çœ‹è‡¨æ™‚èŠå¤©å®¤(expires_at ç‚º5åˆ†é˜å¾Œ)
4. æ‰‹å‹•èª¿ç”¨ check-expiry æˆ–ç­‰å¾…5åˆ†é˜
5. æŸ¥çœ‹å¥½å‹é‚€è«‹
6. é›™æ–¹æ¥å—é‚€è«‹
7. ç¢ºèªæˆç‚ºå¥½å‹,èŠå¤©å®¤å‡ç´šç‚ºæ°¸ä¹…

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ æ³¨æ„äº‹é …
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. è‡¨æ™‚èŠå¤©å®¤æ™‚é–“: ç›®å‰è¨­ç‚º5åˆ†é˜,å¯ä¿®æ”¹ pairing_service.py ç¬¬52è¡Œ
   expires_at = datetime.now() + timedelta(minutes=5)  # é€™è£¡ä¿®æ”¹

2. å¥½å‹é‚€è«‹æœ‰æ•ˆæœŸ: ç›®å‰è¨­ç‚º24å°æ™‚,å¯ä¿®æ”¹ç¬¬91è¡Œ
   expires_at=datetime.now() + timedelta(hours=24)  # é€™è£¡ä¿®æ”¹

3. åœ¨ç·šç‹€æ…‹: ç›®å‰è¿”å›æ¨¡æ“¬æ•¸æ“š,éœ€è¦æ•´åˆ WebSocket å¯¦ç¾çœŸå¯¦æª¢æ¸¬

4. å‰ç«¯éœ€å¯¦ç¾:
   - èŠå¤©å®¤å€’è¨ˆæ™‚ UI
   - å®šæ™‚æª¢æŸ¥éæœŸ(æ¯30ç§’)
   - å¥½å‹é‚€è«‹é€šçŸ¥å½ˆçª—
   - åœ¨ç·šç‹€æ…‹å°ç¶ é»

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š æœå‹™ç‹€æ…‹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… å¾Œç«¯æœå‹™: http://0.0.0.0:8000
âœ… å‰ç«¯æœå‹™: http://0.0.0.0:8080  
âœ… è³‡æ–™åº«: å·²é·ç§»å®Œæˆ
âœ… API æ–‡æª”: http://localhost:8000/docs

æ¸¬è©¦å¸³è™Ÿ:
  Email: testuser_integration@example.com
  Password: Test123!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ ä¸‹ä¸€æ­¥å»ºè­°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å‰ç«¯å¯¦ç¾:
â–¡ èŠå¤©å®¤é é¢æ·»åŠ å€’è¨ˆæ™‚é¡¯ç¤º
â–¡ å¯¦ç¾å®šæ™‚æª¢æŸ¥éæœŸé‚è¼¯(Timer.periodic 30ç§’)
â–¡ å¯¦ç¾å¥½å‹é‚€è«‹é€šçŸ¥UI
â–¡ å¯¦ç¾å¥½å‹åˆ—è¡¨åœ¨ç·šç‹€æ…‹å°ç¶ é»
â–¡ æ•´åˆæ–°çš„é…å°APIåˆ°ç¾æœ‰é…å°æµç¨‹

å¾Œç«¯å„ªåŒ–:
â–¡ æ•´åˆ WebSocket æ¨é€å¥½å‹é‚€è«‹é€šçŸ¥
â–¡ å¯¦ç¾çœŸå¯¦çš„åœ¨ç·šç‹€æ…‹æª¢æ¸¬
â–¡ æ·»åŠ æœ€å¾Œä¸Šç·šæ™‚é–“è¨˜éŒ„
â–¡ å¯¦ç¾è¨Šæ¯å·²è®€ç‹€æ…‹
â–¡ æ·»åŠ èŠå¤©å®¤è¨Šæ¯åˆ†é 

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ‰ åŠŸèƒ½å®Œæˆ!æ‰€æœ‰å¾Œç«¯é‚è¼¯å·²å¯¦ç¾ä¸¦å¯ç”¨æ–¼æ¸¬è©¦!

è©³ç´°ä½¿ç”¨èªªæ˜è«‹åƒé–±: PAIRING_CHAT_GUIDE.md
è³‡æ–™åº«å·²è‡ªå‹•é·ç§»,æœå‹™å·²é‡å•Ÿ,å¯ç«‹å³ä½¿ç”¨æ–°APIã€‚

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
